<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“‹ Ù…ØªØ¬Ø± PIZZA HOT</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box }
    body {
      margin: 0;
      font-family: 'Tajawal', sans-serif;
      background: #f4f1ee;
      color: #2c2c2c;
      line-height: 1.6;
    }
    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: #1a1a1a;
      color: #f2c785;
      text-align: center;
      padding: 12px;
      z-index: 10;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    header a {
      margin: 0 10px;
      color: inherit;
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
    }
    .overlay {
      padding: 90px 10px 160px;
      background: #fff;
      min-height: 100vh;
    }
    h1 {
      text-align: center;
      color: #b22222;
      margin: 20px 0;
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      font-weight: 900;
    }
    .section {
      max-width: 900px;
      margin: 30px auto;
      padding: 0 10px;
    }
    h2 {
      text-align: center;
      color: #8b4513;
      margin-bottom: 12px;
      font-size: 1.4rem;
    }
    .table-wrapper {
      overflow-x: auto;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      margin-bottom: 20px;
      box-shadow: 0 0 8px rgba(0,0,0,0.05);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 1rem;
    }
    th, td {
      text-align: center;
      border: 1px solid #ddd;
      padding: 10px;
    }
    th {
      background: #b22222;
      color: #fff;
    }
    tr:nth-child(even) td {
      background: #fdf5e6;
    }
    select.size, input.qty {
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
      text-align: center;
      font-size: 0.95rem;
    }
    input.qty {
      width: 60px;
    }
    button.add-btn {
      background: #f2c785;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: 700;
      cursor: pointer;
      color: #1a1a1a;
    }
    button.add-btn:hover {
      background: #e0b96a;
    }
    .footer {
      text-align: center;
      color: #666;
      padding: 20px;
      margin-top: 40px;
      border-top: 1px dashed #ccc;
      background: #f9f9f9;
    }
  </style>
</head>
<body>
<header>
  <a href="index.html">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a href="promo_offer.html">ğŸ”¥ Ø§Ù„Ø¹Ø±Ø¶</a>
  <a href="store.html">ğŸ›’ Ø§Ù„Ù…ØªØ¬Ø±</a>
</header>
<div class="overlay">
  <h1>ğŸ“‹ Ù…ØªØ¬Ø± PIZZA HOT</h1>
<div class="section">
  <h2>ğŸ• Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ÙŠØªØ²Ø§</h2>
  <div class="table-wrapper">
    <table id="pizza-menu">
      <thead>
        <tr><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø­Ø¬Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø£Ø¶Ù</th></tr>
      </thead>
      <tbody>
        <tr data-item="Ø¨ÙŠØªØ²Ø§ Ø¯Ø¬Ø§Ø¬"><td>Ø¨ÙŠØªØ²Ø§ Ø¯Ø¬Ø§Ø¬</td>
          <td><select class="size">
            <option value="65">XL â€“ 65â‚ª</option>
            <option value="45">L â€“ 45â‚ª</option>
            <option value="33">M â€“ 33â‚ª</option>
            <option value="17">S â€“ 17â‚ª</option>
          </select></td>
          <td><span class="price">65â‚ª</span></td>
          <td><input class="qty" type="number" min="1" value="1"></td>
          <td><button class="add-btn">Ø£Ø¶Ù</button></td>
        </tr>
        <!-- Ø¨Ø§Ù‚ÙŠ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨ÙŠØªØ²Ø§ Ø¨Ù†ÙØ³ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ -->
      </tbody>
    </table>
  </div>
</div>
<div id="cart-manager" style="position:fixed;bottom:10px;left:10px;width:340px;background:#fff;padding:12px;border:1px solid #ccc;border-radius:6px;z-index:20;box-shadow:0 0 10px rgba(0,0,0,0.1)">
  <input id="user-name" placeholder="Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="width:100%;margin-bottom:6px" />
  <input id="user-address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†/Ù‡Ø§ØªÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="width:100%;margin-bottom:6px" />
  <input id="user-coupon" placeholder="ğŸŸï¸ Ø±Ù…Ø² Ø§Ù„Ø®ØµÙ… (Ø¥Ù† ÙˆØ¬Ø¯)" style="width:100%;margin-bottom:6px" />
  <button id="start-btn" style="width:100%;margin-bottom:10px">â˜‘ Ø¨Ø¯Ø¡ Ø§Ù„Ø·Ù„Ø¨</button>
  <div id="cart-preview" style="margin-top:12px;font-size:0.95rem;color:#333"></div>
</div>
<script src="cartCore.js"></script>
<script src="discountEngine.js"></script>
<script src="discountRules.js"></script>
<script src="messageBuilder.js"></script>
<script src="floatingCart.js"></script>
<script>
CartCore.init(localStorage.getItem("userName"));

// Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„Ø®ØµÙ…
document.getElementById("user-coupon").oninput = (e) => {
  localStorage.setItem("userCoupon", e.target.value.trim());
};

// Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
function addToCart(item, price, qty){
  CartCore.add(item, price, qty);
  renderCart();
}

// ØªÙØ¹ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± "Ø£Ø¶Ù"
document.querySelectorAll('#pizza-menu, #sides-menu, #drinks-menu').forEach(tbl => {
  tbl.addEventListener('change', e => {
    if(e.target.classList.contains('size')){
      const r = e.target.closest('tr');
      r.querySelector('.price').textContent = e.target.value + 'â‚ª';
    }
  });
  tbl.addEventListener('click', e => {
    if(!e.target.classList.contains('add-btn')) return;
    const row = e.target.closest('tr'),
          qty = +row.querySelector('.qty').value,
          sel = row.querySelector('.size'),
          price = sel ? +sel.value : +row.dataset.price,
          item = sel ? `${row.dataset.item} (${sel.selectedOptions[0].text})` : row.dataset.item;
    addToCart(item, price, qty);
  });
});

// ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª
function renderCart(){
  const cartData = CartCore.getCurrentCart();
  const rawTotal = CartCore.total();
  const userName = document.getElementById("user-name").value.trim() || "Ø¶ÙŠÙ";
  const userAddr = document.getElementById("user-address").value.trim();
  localStorage.setItem("userName", userName);
  localStorage.setItem("userAddr", userAddr);

  const { total, applied } = DiscountEngine.apply(rawTotal, cartData, userName);
  const msg = MessageBuilder.build(cartData, userName, userAddr, total, applied);
  const prev = parseInt(localStorage.getItem("monthlySpent") || "0");
  localStorage.setItem("monthlySpent", prev + rawTotal);

  document.getElementById("cart-preview").textContent = msg;
}
</script>
<div class="footer">
  Ø¨Ù„Ø¹ÙŠÙ† â€“ Ø´Ø§Ø±Ø¹ ØµÙØ§ â€“ Ø±Ø§Ù… Ø§Ù„Ù„Ù‡<br>
  Â© 2025 PIZZA HOT â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
</div>
</body>
</html>
